<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Generator - Dashboard</title>
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
</head> 
<body>
    <header class="header">
        <div class="logo">
            <span class="menu-icon" id="menu-toggle">‚ò∞</span>
            <img src="{% static 'images/logo.png' %}" alt="Portfolio Generator Logo">
            <h1>Portfolio Generator</h1>
        </div>
        <div class="search-bar">
            <span class="search-icon">üîç</span>
            <input type="text" placeholder="Search portfolios">
        </div>
        <div class="user-profile">
            {% if profile.profile_photo %}
                <img src="{{ profile.profile_photo.url }}" alt="Profile Photo">
            {% endif %}
        </div>
    </header>
    
    <div class="sidebar" id="sidebar">
        <div class="sidebar-logo">
          <svg class="logo-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.479 10.092C19.267 6.141 16.006 3 12 3C8.109 3 4.921 5.975 4.522 9.772C2.51 10.483 1 12.333 1 14.5C1 17.089 3.108 19.182 5.676 19.456C5.88 19.479 6.085 19.5 6.293 19.5H18.707C18.915 19.5 19.12 19.483 19.324 19.456C21.892 19.182 24 17.089 24 14.5C24 12.347 22.51 10.51 20.521 9.786C20.139 9.882 19.739 10.001 19.479 10.092Z"/>
          </svg>
          <span class="logo-text">Portfolio</span>
        </div>
        
        <a href="{% url 'portfolio:dashboard' %}" class="sidebar-item active">
          <span class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
              <path d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.432z" />
            </svg>
          </span>
          <span>Dashboard</span>
        </a>
        
        <a href="{% url 'portfolio:profile' %}" class="sidebar-item">
          <span class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z" clip-rule="evenodd" />
            </svg>
          </span>
          <span>Profile</span>
        </a>
        
        <a href="{% url 'portfolio:profile' %}" class="sidebar-item">
          <span class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 00-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 00-2.282.819l-.922 1.597a1.875 1.875 0 00.432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 000 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 00-.432 2.385l.922 1.597a1.875 1.875 0 002.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 002.28-.819l.923-1.597a1.875 1.875 0 00-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 000-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 00-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 00-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 00-1.85-1.567h-1.843zM12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z" clip-rule="evenodd" />
            </svg>
          </span>
          <span>Settings</span>
        </a>
        
        <div class="sidebar-footer">
          <a href="{% url 'portfolio:logout' %}" class="sidebar-item">
            <span class="sidebar-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M7.5 3.75A1.5 1.5 0 006 5.25v13.5a1.5 1.5 0 001.5 1.5h6a1.5 1.5 0 001.5-1.5V15a.75.75 0 011.5 0v3.75a3 3 0 01-3 3h-6a3 3 0 01-3-3V5.25a3 3 0 013-3h6a3 3 0 013 3V9A.75.75 0 0115 9V5.25a1.5 1.5 0 00-1.5-1.5h-6zm10.72 4.72a.75.75 0 011.06 0l3 3a.75.75 0 010 1.06l-3 3a.75.75 0 11-1.06-1.06l1.72-1.72H9a.75.75 0 010-1.5h10.94l-1.72-1.72a.75.75 0 010-1.06z" clip-rule="evenodd" />
              </svg>
            </span>
            <span>Logout</span>
          </a>
        </div>
    </div>
    
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <main class="main-content">
        <!-- Recent Portfolios Section -->
        <div class="recent-section">
            <div class="section-header">
                <h2 class="section-title">Recent Portfolios</h2>
                <div class="view-options">
                    <div class="view-option">
                        <span>‚äû</span>
                    </div>
                    <div class="view-option">
                        <span>‚â°</span>
                    </div>
                </div>
            </div>
            <div class="portfolio-grid">
                <!-- Create New Portfolio Button -->
                <div class="portfolio-item create-new" id="create-new-btn">
                    <div class="create-new-icon">+</div>
                    <div class="create-new-text">Create New</div>
                </div>
                
                <!-- User Templates -->
                {% for user_template in user_templates %}
                <div class="portfolio-item" data-id="{{ user_template.template.id }}">
                    <div class="portfolio-preview">
                        <img src="{{user_template.template.preview_image.url}}" alt="Portfolio Preview">
                    </div>
                    <div class="portfolio-details">
                        <div class="portfolio-title">{{ user_template.template.name }}</div>
                        <div class="portfolio-meta">
                            Edited {{ user_template.updated_at|timesince }} ago
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <!-- Template Gallery Section -->
        <div class="templates-section">
            <div class="section-header">
                <h2 class="section-title">Template Gallery</h2>
            </div>
            <div class="portfolio-grid">
                <!-- Available Templates -->
                {% for template in templates %}
                <div class="portfolio-item" data-id="template{{ template.id }}" data-name="{{ template.name }}" data-description="{{ template.description }}" data-url="{% url 'portfolio:choose_template' template.id %}">
                    <div class="portfolio-preview">
                        <img src="{{template.preview_image.url}}" alt="Template Preview">
                    </div>
                    <div class="portfolio-details">
                        <div class="portfolio-title">{{ template.name }}</div>
                        <div class="portfolio-meta">
                            Template
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </main>
    
    <!-- Context Menu -->
    <div class="context-menu" id="context-menu">
        <div class="context-menu-item">
            <span class="context-menu-icon">üìã</span>
            <span>Open</span>
        </div>
        <div class="context-menu-item">
            <span class="context-menu-icon">‚úèÔ∏è</span>
            <span>Rename</span>
        </div>
        <div class="context-menu-item">
            <span class="context-menu-icon">‚≠ê</span>
            <span>Add to starred</span>
        </div>
        <div class="context-menu-item">
            <span class="context-menu-icon">üîó</span>
            <span>Get shareable link</span>
        </div>
        <div class="context-menu-item">
            <span class="context-menu-icon">üì§</span>
            <span>Export</span>
        </div>
        <div class="context-menu-item">
            <span class="context-menu-icon">üóëÔ∏è</span>
            <span>Move to trash</span>
        </div>
    </div>
    
    <!-- Create New Portfolio Dialog -->
    <div class="dialog-overlay" id="create-dialog">
        <div class="dialog">
            <div class="dialog-header">
                <h3 class="dialog-title">Create new portfolio</h3>
                <button class="dialog-close" id="dialog-close">√ó</button>
            </div>
            <div class="dialog-content">
                <div class="template-options">
                    {% for template in templates %}
                    <div class="template-option" data-template="{{ template.id }}">
                        <div class="template-icon">üìÑ</div>
                        <div class="template-name">{{ template.name }}</div>
                    </div>
                    {% endfor %}
                </div>
                <div class="template-preview">
                    <div class="template-preview-placeholder" id="preview-placeholder">
                        Select a template to see preview
                    </div>
                    {% for template in templates %}
                    <img src="{% static 'images/portfolio.png' %}" alt="{{ template.name }} Preview" class="template-preview-img" id="preview-template{{ template.id }}">
                    {% endfor %}
                </div>
            </div>
            <div class="dialog-footer">
                <button class="btn btn-secondary" id="cancel-btn">Cancel</button>
                <button class="btn btn-primary" id="create-btn" disabled>Create</button>
            </div>
        </div>
    </div>
    
    <!-- Template Preview Dialog -->
    <div class="preview-dialog-overlay" id="preview-dialog">
        <div class="preview-dialog">
            <div class="preview-dialog-header">
                <h3 class="preview-dialog-title" id="preview-template-title">Template Preview</h3>
                <button class="preview-dialog-close" id="preview-dialog-close">√ó</button>
            </div>
            <div class="preview-dialog-content">
                <img src="" alt="Template Full Preview" class="template-preview-full" id="preview-template-img">
                <div class="template-description" id="preview-template-description">
                    <!-- Template description will be dynamically inserted here -->
                </div>
            </div>
            <div class="preview-dialog-footer">
                <button class="btn btn-secondary" id="preview-close-btn">Close</button>
                <!-- Changed from button to link -->
                <a href="#" class="btn btn-primary" id="preview-use-template-btn" style="text-decoration: none;">Use This Template</a>
            </div>
        </div>
    </div>
    
    <!-- User Template Preview Dialog -->
    <div class="preview-dialog-overlay" id="user-template-preview-dialog">
        <div class="preview-dialog">
            <div class="preview-dialog-header">
                <h3 class="preview-dialog-title" id="user-template-preview-title">Portfolio Preview</h3>
                <button class="preview-dialog-close" id="user-template-preview-close">√ó</button>
            </div>
            <div class="preview-dialog-content">
                <img src="" alt="Portfolio Full Preview" class="template-preview-full" id="user-template-preview-img">
                <div class="template-description" id="user-template-preview-description">
                    <!-- Portfolio description will be dynamically inserted here -->
                </div>
            </div>
            <div class="preview-dialog-footer">
                <button class="btn btn-secondary" id="user-template-preview-close-btn">Close</button>
                <a href="#" class="btn btn-primary" id="user-template-download-btn" style="text-decoration: none;">Download</a>
                <a href="#" class="btn btn-primary" id="user-template-delete-btn" style="text-decoration: none; background-color: rgb(255, 132, 0);">Delete</a>
            </div>
        </div>
    </div>
    <script src="{% static 'js/dashboard.js' %}"></script>
</body>
</html>