<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Profile</title>
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
</head>
<body>
    
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-logo">
          <svg class="logo-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.479 10.092C19.267 6.141 16.006 3 12 3C8.109 3 4.921 5.975 4.522 9.772C2.51 10.483 1 12.333 1 14.5C1 17.089 3.108 19.182 5.676 19.456C5.88 19.479 6.085 19.5 6.293 19.5H18.707C18.915 19.5 19.12 19.483 19.324 19.456C21.892 19.182 24 17.089 24 14.5C24 12.347 22.51 10.51 20.521 9.786C20.139 9.882 19.739 10.001 19.479 10.092Z"/>
          </svg>
          <span class="logo-text">Portfolio</span>
        </div>
        
        <a href="{% url 'portfolio:dashboard' %}" class="sidebar-item">
          <span class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
              <path d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.432z" />
            </svg>
          </span>
          <span>Dashboard</span>
        </a>
        
        <a href="{% url 'portfolio:profile' %}" class="sidebar-item" active>
          <span class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z" clip-rule="evenodd" />
            </svg>
          </span>
          <span>Profile</span>
        </a>
        
        <a href="{% url 'portfolio:profile' %}" class="sidebar-item">
          <span class="sidebar-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 00-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 00-2.282.819l-.922 1.597a1.875 1.875 0 00.432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 000 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 00-.432 2.385l.922 1.597a1.875 1.875 0 002.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 002.28-.819l.923-1.597a1.875 1.875 0 00-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 000-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 00-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 00-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 00-1.85-1.567h-1.843zM12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z" clip-rule="evenodd" />
            </svg>
          </span>
          <span>Settings</span>
        </a>
        
        <div class="sidebar-footer">
          <a href="{% url 'portfolio:logout' %}" class="sidebar-item">
            <span class="sidebar-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M7.5 3.75A1.5 1.5 0 006 5.25v13.5a1.5 1.5 0 001.5 1.5h6a1.5 1.5 0 001.5-1.5V15a.75.75 0 011.5 0v3.75a3 3 0 01-3 3h-6a3 3 0 01-3-3V5.25a3 3 0 013-3h6a3 3 0 013 3V9A.75.75 0 0115 9V5.25a1.5 1.5 0 00-1.5-1.5h-6zm10.72 4.72a.75.75 0 011.06 0l3 3a.75.75 0 010 1.06l-3 3a.75.75 0 11-1.06-1.06l1.72-1.72H9a.75.75 0 010-1.5h10.94l-1.72-1.72a.75.75 0 010-1.06z" clip-rule="evenodd" />
              </svg>
            </span>
            <span>Logout</span>
          </a>
        </div>
    </div>
    
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <!-- Main Content -->
    <div class="container">
        <!-- Personal Information Section -->
        <div class="profile-card">
            <div class="card-header">
                <h2 class="card-title">Personal Information</h2>
            </div>
            <div class="card-content">
                
                <form id="personalInfoForm" method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="profile-avatar">
                        <label for="profile-photo-input" style="cursor: pointer;">
                            {% if portfolio_form.instance.profile_photo %}
                                <img src="{{ portfolio_form.instance.profile_photo.url }}" alt="Profile Photo">
                            {% else %}
                                <div class="avatar-initials">
                                    {{ user_info.email|slice:":2"|upper }}
                                </div>
                            {% endif %}
                        </label>
                        <input type="file" id="profile-photo-input" name="profile_photo" accept="image/*" style="display: none;">
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="name">Full Name</label>
                                {{ portfolio_form.name }}
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="title">Professional Title</label>
                                {{ portfolio_form.designation }}
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="email">Email</label>
                                {{ portfolio_form.email }}
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="phone">Phone</label>
                                {{ portfolio_form.phone }}
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="location">Location</label>
                                <input type="text" id="location" name="location" placeholder="e.g. New York, NY" value="{{ user.location }}">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="website">Website</label>
                                <input type="url" id="website" name="website" placeholder="e.g. https://johndoe.com" value="{{ user.website }}">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="bio">Biography</label>
                        {{ portfolio_form.short_bio }}
                    </div>
                    
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary">Save Personal Information</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Skills Section -->
        <div class="profile-card">
            <div class="card-header">
                <h2 class="card-title">Skills</h2>
            </div>
            <div class="card-content">
                <div class="skills-container">
                    {% for skill in skills %}
                    <div class="badge">
                        {{ skill.skill_name }}
                    </div>
                    {% endfor %}
                </div>

                <form id="skillsForm" method="POST">
                    {% csrf_token %}
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="skill">Add New Skill</label>
                                {{ skill_form.skill_name }}
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary">Save Skills</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Work Experience Section -->
        <div class="profile-card">
            <div class="card-header">
                <h2 class="card-title">Work Experience</h2>
            </div>
            <div class="card-content">
                <div>
                    {% for work in work_experience %}
                    <div class="experience-item">
                        <div class="item-header">
                            <div>
                                <div class="item-title">{{ work.company_name }}</div>
                                <div class="item-subtitle">{{ work.job_duration }}</div>
                            </div>
                            <div class="item-date">{{ work.start_date }} - {{ work.end_date|default:"Present" }}</div>
                        </div>
                        <div class="item-content">{{ work.job_responsibilities }}</div>
                    </div>
                    {% endfor %}
                </div>

                <form id="experienceForm" method="POST">
                    {% csrf_token %}
                    <div class="experience-item">
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="jobTitle">Job Title</label>
                                    {{ work_experience_form.company_name }}
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="company">Job Duration</label>
                                    {{ work_experience_form.job_duration }}
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="startDate">Start Date</label>
                                    <input type="month" id="startDate" name="startDate">
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="endDate">End Date</label>
                                    <input type="month" id="endDate" name="endDate">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="jobDescription">Description</label>
                            {{ work_experience_form.job_responsibilities }}
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary">Save Work Experience</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Education Section -->
        <div class="profile-card">
            <div class="card-header">
                <h2 class="card-title">Education</h2>
            </div>
            <div class="card-content">
                <div>
                    {% for academic in academic_background %}
                    <div class="education-item">
                        <div class="item-header">
                            <div>
                                <div class="item-title">{{ academic.degree }}</div>
                                <div class="item-subtitle">{{ academic.institute }}</div>
                            </div>
                            <div class="item-date">{{ academic.year_of_graduation }}</div>
                        </div>
                        <div class="item-content">
                            {% if academic.grade %}<div style="margin-bottom: 0.5rem;"><strong>GPA:</strong> {{ academic.grade }}</div>{% endif %}
                            {{ academic.description }}
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <form id="educationForm" method="POST">
                    {% csrf_token %}
                    <div class="education-item">
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="degree">Degree</label>
                                    {{ academic_form.degree }}
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="institution">Institution</label>
                                    {{ academic_form.institute }}
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="graduationDate">Graduation Date</label>
                                    {{ academic_form.year_of_graduation }}
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label for="gpa">GPA (Optional)</label>
                                    {{ academic_form.grade }}
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="educationDescription">Description</label>
                            <textarea id="educationDescription" name="educationDescription" rows="3" placeholder="Describe your courses, achievements, or activities..."></textarea>
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <button type="submit" class="btn btn-primary">Save Education</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- JavaScript for sidebar toggle -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            
            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                sidebarOverlay.classList.toggle('active');
            });
            
            sidebarOverlay.addEventListener('click', function() {
                sidebar.classList.remove('active');
                sidebarOverlay.classList.remove('active');
            });
        });
        document.getElementById('profile-photo-input').addEventListener('click', function(event) {
            event.stopPropagation();  // Ensure the file dialog is not blocked
        });
    </script>
</body>
</html>